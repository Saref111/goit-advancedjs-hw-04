{"version":3,"file":"commonHelpers.js","sources":["../src/js/api.js","../src/js/ui.js","../src/js/pagination.js","../src/js/endlessScroll.js","../src/js/search-form.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '40884603-5ad171707053fe9611639638b';\n\nexport const fetchImages = ({\n  searchQuery = '',\n  currentPage = 1,\n  pageSize = 40,\n}) =>\n  axios(\n    `${BASE_URL}?image_type=photo&orientation=horizontal&q=${searchQuery}&page=${currentPage}&per_page=${pageSize}&key=${API_KEY}&safeSearch=true`\n  );\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\n\nimport 'izitoast/dist/css/iziToast.min.css';\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst loadMoreButtonElement = document.querySelector('.load-more');\nconst imagesList = document.querySelector('.gallery');\nlet lightbox;\n\nconst renderImagesListItem = item => {\n  return `\n          <li class=\"gallery__item\">\n              <a href=\"${item.largeImageURL}\">\n                  <img \n                      src=\"${item.webformatURL}\" \n                      alt=\"${item.tags}\" \n                      class=\"gallery__image\" \n                      loading=\"lazy\"    \n                  />\n              </a>\n              <div class=\"info\">\n                  <p class=\"info__item\">\n                      <b>Likes</b> ${item.likes}\n                  </p>\n                  <p class=\"info__item\">\n                      <b>Views</b> ${item.views}\n                  </p>\n                  <p class=\"info__item\">\n                      <b>Comments</b> ${item.comments}\n                  </p>\n                  <p class=\"info__item\">\n                      <b>Downloads</b> ${item.downloads}\n                  </p> \n              </div>\n          </li>\n      `;\n};\n\nexport const showLoadMoreButton = cb => {\n  if (loadMoreButtonElement.classList.contains('load-more--visible')) return;\n\n  loadMoreButtonElement.addEventListener('click', cb);\n  loadMoreButtonElement.classList.add('load-more--visible');\n};\n\nexport const hideLoadMoreButton = cb => {\n  loadMoreButtonElement.removeEventListener('click', cb);\n  loadMoreButtonElement.classList.remove('load-more--visible');\n};\n\nexport const clearList = () => {\n  imagesList.innerHTML = '';\n};\n\nexport const renderImagesList = (list, isPaginated) => {\n  if (!isPaginated) {\n    clearList();\n  }\n\n  const imageElements = list.map(renderImagesListItem).join('');\n\n  imagesList.insertAdjacentHTML('beforeend', imageElements);\n};\n\nexport const renderError = message => {\n  iziToast.error({\n    title: 'Error',\n    message,\n    position: 'bottomRight',\n  });\n};\n\nexport const renderNotification = message => {\n  iziToast.success({\n    title: 'Success',\n    message,\n    position: 'bottomRight',\n  });\n};\n\nexport const renderInfo = message => {\n  iziToast.info({\n    title: 'Info',\n    message,\n    position: 'bottomRight',\n  });\n};\n\nexport const setSimpleLightbox = () => {\n    if (!lightbox) {\n        lightbox = new SimpleLightbox('.gallery a', {\n            captionsData: 'alt',\n            captionDelay: 250,\n        });\n    } else {\n        lightbox.refresh();\n    }\n};\n\nexport const scrollDown = () => {\n    const { height: cardHeight } = imagesList.firstElementChild.getBoundingClientRect();\n\n    window.scrollBy({\n        top: cardHeight * 2,\n        behavior: \"smooth\",\n    });\n}\n","const requestData = {\n  searchQuery: '',\n  currentPage: 1,\n  pageSize: 40,\n};\n\nexport const isListEnd = (responseData, _requestData) => {\n  return (\n    responseData.totalHits - _requestData.currentPage * _requestData.pageSize <=\n    0\n  );\n};\n\nexport const updateRequestData = (searchQuery, targetElement) => {\n  if (requestData.searchQuery !== searchQuery || targetElement.tagName === 'FORM') {\n    requestData.searchQuery = searchQuery;\n    requestData.currentPage = 1;\n  }\n  return { ...requestData };\n};\n\nexport const incrementPage = () => {\n  requestData.currentPage += 1;\n};\n","let callbacks = [];\nexport const enableLoadingOnScroll = cb => {\n  const callback = e => {\n    if (window.innerHeight + window.scrollY >= document.body.offsetHeight) {\n      cb(e);\n    }\n  };\n  callbacks.push(callback);\n  window.addEventListener('scroll', callback);\n};\n\nexport const disableLoadingOnScroll = () => {\n  callbacks.forEach(cb => {\n    window.removeEventListener('scroll', cb);\n  });\n  callbacks = [];\n};\n","import { fetchImages } from './api';\nimport {\n  renderImagesList,\n  renderError,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n  clearList,\n  renderNotification,\n  renderInfo,\n  setSimpleLightbox,\n  scrollDown,\n} from './ui';\nimport { isListEnd, updateRequestData, incrementPage } from './pagination';\nimport { enableLoadingOnScroll, disableLoadingOnScroll } from './endlessScroll';\n\nconst handleError = error => {\n  renderError(error.message);\n  clearList();\n};\n\nconst handleListEnd = handleLoad => {\n  // hideLoadMoreButton(handleLoad);\n  disableLoadingOnScroll(); // comment this line and uncomment the previous one to use the load more button\n  renderInfo(\"We're sorry, but you've reached the end of search results.\");\n};\n\nconst renderList = (requestData, responseData, handleLoad) => {\n  const isPaginated = requestData.currentPage !== 1;\n  renderImagesList(responseData.hits, isPaginated);\n  setSimpleLightbox();\n  // showLoadMoreButton(handleLoad);\n  enableLoadingOnScroll(handleLoad); // comment this line and uncomment the previous one to use the load more button\n  incrementPage();\n\n  if (isPaginated) {\n    scrollDown();\n  } else {\n    renderNotification(`Hooray! We found ${responseData.totalHits} images.`);\n  }\n};\n\nexport const setUpForm = searchFormElement => {\n  const handleLoad = async event => {\n    event.preventDefault();\n    // hideLoadMoreButton(handleLoad);\n    disableLoadingOnScroll(); // comment this line and uncomment the previous one to use the load more button\n\n    const formData = new FormData(searchFormElement);\n    const searchQuery = formData.get('searchQuery');\n    if (!searchQuery.trim()) return renderError('The query string is empty.');\n    const requestData = updateRequestData(searchQuery, event.target);\n\n    try {\n      const {data: resp} = await fetchImages({ ...requestData });\n\n      if (!resp.hits.length) {\n        throw new Error(\n          'Sorry, there are no images matching your search query. Please try again.'\n        );\n      }\n\n      renderList(requestData, resp, handleLoad);\n\n      if (isListEnd(resp, requestData)) {\n        handleListEnd(handleLoad);\n        return;\n      }\n    } catch (error) {\n      console.log(error);\n      handleError(error);\n    }\n  };\n\n  searchFormElement.addEventListener('submit', event => {\n    handleLoad(event);\n  });\n};\n","import { setUpForm } from \"./js/search-form\";\n\nconst searchFormElement = document.querySelector('.search-form');\nsetUpForm(searchFormElement);\n"],"names":["BASE_URL","API_KEY","fetchImages","searchQuery","currentPage","pageSize","axios","imagesList","lightbox","renderImagesListItem","item","clearList","renderImagesList","list","isPaginated","imageElements","renderError","message","iziToast","renderNotification","renderInfo","setSimpleLightbox","SimpleLightbox","scrollDown","cardHeight","requestData","isListEnd","responseData","_requestData","updateRequestData","targetElement","incrementPage","callbacks","enableLoadingOnScroll","cb","callback","e","disableLoadingOnScroll","handleError","error","handleListEnd","handleLoad","renderList","setUpForm","searchFormElement","event","resp"],"mappings":"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"}